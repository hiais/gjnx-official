---
interface Props {
  name: string;
  href?: string;
  status?: 'active' | 'locked' | 'missing';
  class?: string;
}

const { name, href, status = 'locked', class: className } = Astro.props;

// 截取简短名称用于徽章显示 (最多显示2行)
// e.g. "2nm / 1.8nm (Angstrom Era)" -> "2nm"
// 简单的启发式截断，以后可以优化
const shortName = name.split(/[\(\/]/)[0].trim();
---

<a 
  href={href} 
  class:list={[
    'tech-badge', 
    `status-${status}`,
    className
  ]}
  onclick="event.stopPropagation()"
>
  <div class="badge-content">
    <span class="badge-text">{shortName}</span>
  </div>
  <div class="badge-glitch"></div>
</a>

<style>
  .tech-badge {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    aspect-ratio: 1; /* 正方形/六边形基础 */
    text-decoration: none;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    isolation: isolate;
  }

  .badge-content {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 4px;
    clip-path: polygon(15% 0, 85% 0, 100% 15%, 100% 85%, 85% 100%, 15% 100%, 0 85%, 0 15%);
    background: rgba(10, 10, 10, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s;
  }

  .badge-text {
    font-size: 0.75rem;
    line-height: 1.1;
    font-family: var(--font-mono);
    color: var(--c-text-secondary);
    word-break: break-word;
  }

  /* Active State (Neon Cyan) */
  .status-active .badge-content {
    background: rgba(0, 240, 255, 0.1);
    border-color: rgba(0, 240, 255, 0.5);
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.1);
  }

  .status-active .badge-text {
    color: var(--c-accent-cyan);
    font-weight: bold;
    text-shadow: 0 0 5px rgba(0, 240, 255, 0.5);
  }

  /* Locked State (Dimmed) */
  .status-locked .badge-content {
    background: rgba(255, 255, 255, 0.02);
    border-style: dashed;
    opacity: 0.7;
  }

  /* Hover Effects */
  .tech-badge:hover {
    transform: scale(1.1);
    z-index: 10;
  }

  .tech-badge:hover .badge-content {
    background: rgba(0, 240, 255, 0.2);
    border-color: var(--c-accent-cyan);
    box-shadow: 0 0 15px rgba(0, 240, 255, 0.3);
  }

  .tech-badge:hover .badge-text {
    color: #fff;
  }

  /* Missing Content State */
  .status-missing .badge-content {
    border-color: rgba(255, 50, 50, 0.3);
  }
  .status-missing:hover .badge-content {
    border-color: rgba(255, 50, 50, 0.8);
    box-shadow: 0 0 10px rgba(255, 50, 50, 0.2);
  }

</style>
